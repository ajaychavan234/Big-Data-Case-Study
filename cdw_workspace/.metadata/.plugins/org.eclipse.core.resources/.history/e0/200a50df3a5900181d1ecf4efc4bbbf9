package com.cdw.runner;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;

import com.cdw.dao.TransactionDAO;
import com.cdw.model.Transaction;

public class CustomerRunner {

	static Scanner scan = new Scanner(System.in);
	static String del = ",";
			
		//1
		public void tranByZip() {
			try {
				System.out.print("Enter a Zipcode: ");
				String zip = scan.next();
				System.out.print("Enter a Month: ");
				String month = scan.next();
				System.out.print("Enter a Year: ");
				String year = scan.next();
				System.out.println();
				
				//TEST DATA		Zip: 39120 Month: 9 Year: 2018
				TransactionDAO tDAO = new TransactionDAO();
				ArrayList<Transaction> tran = tDAO.getTranByZip(zip, Integer.parseInt(month), Integer.parseInt(year));
				String output = ""; 
				for (Transaction n : tran) {
					System.out.println("ID: " + n.getTranID());
					System.out.println("Day: " + n.getDay());
					System.out.println("Month: " + n.getMonth());
					System.out.println("Year: " + n.getYear());
					System.out.println("Credit NO: " + n.getCreditNo());
					System.out.println("SSN: " + n.getSsn());
					System.out.println("Branch Code: " + n.getBranchCode());
					System.out.println("Transaction Type: " + n.getTranType());
					System.out.println("Transaction Value: " + n.getTranVal());
					System.out.println();
					
					output += n.getTranID() + del + n.getDay() + del + n.getMonth() + del + n.getYear() + del + String .valueOf(n.getCreditNo()) + del + n.getSsn() + del + n.getSsn() 
						+ del + n.getBranchCode() + del + n.getTranType() + del + n.getTranVal() + "\n";
				}
				System.out.print("Export to CSV file? (y/n): ");
				if (scan.next().equals("y")) export(output);
			} catch (java.lang.Exception e) {
				System.out.println("NO DATA.");
			}
		}
		
		
		
		//2
		public void tranSumByTranType() {
			try {
				System.out.print("Enter a Transaction Type: ");
				String type = scan.next();
				System.out.println();
				
				//TEST DATA		Type: Gas
				TransactionDAO tDAO = new TransactionDAO();
				Transaction tran = tDAO.getTranSumByTranType(type);
				System.out.println("Number of Transactions: " + tran.getCount());
				System.out.println("Total Value: " + tran.getTranVal());
			} catch (java.lang.Exception e) {
				System.out.println("NO DATA.");
			}
		}
		
		
		
		//3
		public void tranSumByState() {
			System.out.print("Enter a State Abbreviation: ");
			String state = scan.next().toUpperCase();
			System.out.println();
			
			//TEST DATA		State: IL,il
			TransactionDAO tDAO = new TransactionDAO();
			ArrayList<Transaction> tran = tDAO.getTranSumByState(state);
			for (Transaction n : tran) {
				System.out.println("Bank Name: " + n.getTranType());
				System.out.println("Number of Transactions: " + n.getCount());
				System.out.println("Total Value: " + n.getTranVal());
				System.out.println();
			}
		}
	
		
	
		
		public void export(String output) throws IOException {
			FileWriter fw = new FileWriter("output.csv");
			BufferedWriter bw = new BufferedWriter(fw);
			bw.write(output); bw.close();
			System.out.println("File EXPORTED.");
		}
	}//end of class

